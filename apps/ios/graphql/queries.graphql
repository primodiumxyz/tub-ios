query GetAllAccounts {
  account {
    id
    username
    created_at
  }
}

query GetAllTokens {
  token {
    id
    name
    symbol
    updated_at
    supply
    uri
  }
}

query GetAccountBalanceCredit($accountId: uuid!) {
  account_transaction_aggregate(where: { account: { _eq: $accountId }, transaction_type: { _eq: "credit" } }) {
    aggregate {
      sum {
        amount
      }
    }
  }
}

query GetAccountBalanceDebit($accountId: uuid!) {
  account_transaction_aggregate(where: { account: { _eq: $accountId }, transaction_type: { _eq: "debit" } }) {
    aggregate {
      sum {
        amount
      }
    }
  }
}

query GetAccountTokenCredit($accountId: uuid!, $tokenId: uuid!) {
  token_transaction_aggregate(
    where: {
      account_transaction_data: { account: { _eq: $accountId } }
      token: { _eq: $tokenId }
      transaction_type: { _eq: "credit" }
    }
  ) {
    aggregate {
      sum {
        amount
      }
    }
  }
}

query GetAccountTokenDebit($accountId: uuid!, $tokenId: uuid!) {
  token_transaction_aggregate(
    where: {
      account_transaction_data: { account: { _eq: $accountId } }
      token: { _eq: $tokenId }
      transaction_type: { _eq: "debit" }
    }
  ) {
    aggregate {
      sum {
        amount
      }
    }
  }
}

query GetTokenPrice($tokenId: uuid!) {
  token_price_history(where: { token: { _eq: $tokenId } }, order_by: { created_at: desc }, limit: 1) {
    created_at
    id
    price
    token
  }
}

query GetAccountTransactions($accountId: uuid!) {
    token_transaction(order_by: {account_transaction_data: {created_at: desc}}, where: {account_transaction_data: {account_data: {id: {_eq: $accountId}}}}) {
      account_transaction
      amount
      id
      token
      token_data {
        id
        name
        supply
        symbol
        uri
      }
      transaction_type
      account_transaction_data {
        created_at
      }
      token_price {
        price
        created_at
      }
    }
  }
